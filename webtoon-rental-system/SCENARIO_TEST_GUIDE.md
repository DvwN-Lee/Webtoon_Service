# 웹툰 대여 시스템 - 시나리오 테스트 가이드

## 실행 방법

```bash
cd webtoon-rental-system
export JAVA_HOME=/opt/homebrew/Cellar/openjdk@21/21.0.9/libexec/openjdk.jdk/Contents/Home
export PATH=$JAVA_HOME/bin:$PATH
./gradlew run
```

## 샘플 데이터

애플리케이션 최초 실행 시 자동으로 생성됩니다.

### 작가 계정 (3명)
- ID: `chugong` / PW: `1234` / 작가명: 추공
- ID: `geomma` / PW: `1234` / 작가명: 검마
- ID: `ant_writer` / PW: `1234` / 작가명: 안트

### 웹툰 작품 (3개)
1. **나 혼자만 레벨업** (추공, 연재중, 15화, 판타지/액션)
2. **마검의 계승자** (검마, 연재중, 20화, 판타지)
3. **던전 리셋** (안트, 완결, 10화, 판타지/코미디)

---

## 테스트 시나리오

### 시나리오 1: 작가 로그인 및 웹툰 관리

**목적**: 작가가 자신의 웹툰을 관리하는 기능 검증

**단계**:
1. 시작 메뉴에서 `2` (로그인) 선택
2. 계정 유형에서 `1` (작가) 선택
3. ID 입력: `chugong`
4. 비밀번호 입력: `1234`
5. 작가 메뉴 확인
   - 내 웹툰 목록 조회 (`1`)
   - 웹툰 상세 보기 (`2`)
   - 회차 업로드 (`3`)
   - 통계 보기 (`4`)
6. 로그아웃 (`0`)

**예상 결과**:
- 로그인 성공 메시지 표시
- 작가명 "추공" 표시
- "나 혼자만 레벨업" 웹툰 정보 확인
- 15개 회차 목록 표시

---

### 시나리오 2: 독자 회원가입 및 웹툰 탐색

**목적**: 신규 독자가 가입하고 웹툰을 탐색하는 기능 검증

**단계**:
1. 시작 메뉴에서 `1` (회원가입) 선택
2. 계정 유형에서 `1` (독자) 선택
3. ID 입력: `testReader` (5-20자)
4. 비밀번호 입력: `test1234` (4-20자)
5. 닉네임 입력: `테스트독자` (2-10자)
6. 회원가입 완료 확인 (1000P 지급)
7. 로그인 (`2` → `2` → `testReader` → `test1234`)
8. 독자 메뉴에서:
   - 웹툰 목록 조회 (`1`)
   - 인기 웹툰 보기 (`2`)
   - 웹툰 검색 (`3`) → "레벨업" 검색

**예상 결과**:
- 회원가입 성공, 1000P 지급
- 웹툰 3개 목록 표시
- 검색 결과: "나 혼자만 레벨업" 1건

---

### 시나리오 3: 웹툰 팔로우 및 알림 수신

**목적**: Observer 패턴 구현 검증

**단계**:
1. 독자 계정으로 로그인 (시나리오 2에서 생성한 계정)
2. 웹툰 목록 조회 (`1`)
3. "나 혼자만 레벨업" 선택 (`1`)
4. 웹툰 상세 정보 확인
5. 팔로우 (`1`)
6. 로그아웃 후 작가 계정(chugong)으로 로그인
7. 새 회차 업로드 (`3`)
   - 웹툰 선택: `1` (나 혼자만 레벨업)
   - 제목: "16화. 새로운 시작"
   - 내용: "테스트 내용"
   - 대여가: `50`
   - 구매가: `100`
8. 로그아웃 후 독자 계정으로 다시 로그인
9. 알림 확인 (`5`)

**예상 결과**:
- 팔로우 성공 메시지
- 새 회차 발행 성공
- 독자 알림함에 "'나 혼자만 레벨업'에 새 회차가 추가되었습니다." 알림 표시

---

### 시나리오 4: 회차 대여 및 포인트 차감

**목적**: 대여 시스템 및 포인트 관리 검증

**참고**: 이 기능은 AccessService에 구현되어 있으나 CLI 메뉴에 완전히 통합되지 않았을 수 있습니다.

**단계**:
1. 독자 계정으로 로그인
2. 내 포인트 확인 (홈 화면에 표시)
3. 웹툰 회차 보기
4. 대여 선택 (50P 차감)
5. 대여 시간 확인 (10분)
6. 대여 목록 확인

**예상 결과**:
- 대여 전 포인트: 1000P
- 대여 후 포인트: 950P
- 대여 만료 시간: 현재 시각 + 10분
- 대여 목록에서 해당 회차 확인 가능

---

### 시나리오 5: 포인트 충전

**목적**: 포인트 충전 시스템 검증

**단계**:
1. 독자 계정으로 로그인
2. 포인트 충전 메뉴 선택
3. 충전 방법 선택
   - 신용카드: 10,000원 → 1,000P
   - 계좌이체: 5,000원 → 500P
4. 충전 완료 확인

**예상 결과**:
- 결제 성공 메시지
- 포인트 증가 확인
- 결제 내역 저장

---

## 데이터 초기화

테스트를 다시 시작하려면 샘플 데이터를 삭제하세요:

```bash
rm -f src/main/resources/data/*.json
```

다음 실행 시 샘플 데이터가 자동으로 다시 생성됩니다.

---

## 검증 포인트

### 1. 데이터 영속성
- 애플리케이션 종료 후 재실행 시 데이터 유지 확인
- `src/main/resources/data/*.json` 파일 확인

### 2. 입력 검증
- 잘못된 ID/비밀번호 입력 시 오류 메시지
- 중복 ID 회원가입 시도 시 거부
- 형식에 맞지 않는 입력 시 재입력 요청

### 3. 비즈니스 로직
- 포인트 부족 시 대여/구매 불가
- 대여 만료 시간 정확성
- 팔로우한 웹툰만 알림 수신
- 작가는 자신의 웹툰만 수정 가능

### 4. Observer 패턴
- 팔로워에게만 알림 발송
- 여러 독자가 팔로우한 경우 모두에게 알림
- 알림 읽음/안읽음 상태 관리

---

## 알려진 제한사항

1. **대여 만료 시간**: 데모 목적으로 10분으로 설정됨 (실제 서비스: 24시간)
2. **CLI 인터페이스**: 일부 고급 기능은 메뉴에 완전히 통합되지 않았을 수 있음
3. **동시성**: 단일 사용자 세션만 지원 (멀티 세션 미지원)

---

## 문제 발생 시

### 빌드 오류
```bash
./gradlew clean build
```

### 테스트 실행
```bash
./gradlew test
```

### 로그 확인
애플리케이션 실행 중 콘솔에 표시되는 로그 메시지를 확인하세요.

---

## 자동화된 테스트

단위 테스트 및 통합 테스트는 다음 명령으로 실행할 수 있습니다:

```bash
# 전체 테스트 (68개)
./gradlew test

# 시나리오 통합 테스트만 실행 (6개)
./gradlew test --tests "ScenarioIntegrationTest"
```

**테스트 결과**:
- 단위 테스트: 68/68 통과 ✅
- 시나리오 통합 테스트: 6/6 통과 ✅
